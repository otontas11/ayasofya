<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script> -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">

  <script src="https://cdn.jsdelivr.net/sharer.js/latest/sharer.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
  <title>Document</title>
  <style>
    html,
    body {
      width: 100%;
      height: 100%;
      text-align: center;
      margin: 0;
    }

    #canvas {
      background-color: #ccc;
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      width: 100%;
      height: 100%;
    }

    .container {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translateX(-50%);
    }

    @font-face {
      font-family: 'Poppin';
      src: url('./fonts/Museo700-Regular.otf');
    }
  </style>
</head>

<body>
  <!-- <img src="./images/ayasofya.jpg" id="sample" /> -->
  <canvas id="myCanvas" width="500" height="500">
    Lütfen farklı bir tarayıcı deneyiniz
  </canvas>


 

  <script>
    let imgData = "";
    //resmi önce 64 bite cevir
    function convertImageToBase64(img, outputFormat) {
      var originalWidth = img.style.width;
      var originalHeight = img.style.height;

      img.style.width = "auto";
      img.style.height = "auto";
      img.crossOrigin = "Anonymous";

      var canvas = document.createElement("canvas");

      canvas.width = img.width;
      canvas.height = img.height;

      var ctx = canvas.getContext("2d");
      ctx.drawImage(img, 0, 0);

      img.style.width = originalWidth;
      img.style.height = originalHeight;

      var dataUrl = canvas.toDataURL(outputFormat);

      return dataUrl;
    }

    //resmi önce 64 bite cevir

    function convertImageUrlToBase64(url, callback, outputFormat) {
      var img = new Image();
      img.crossOrigin = "anonymous";
      img.onload = function () {
        callback(convertImageToBase64(this, outputFormat));
      };
      img.src = url;
    }

    //donusturme
    convertImageUrlToBase64("./images/ayasofya.jpg", function (url) {
      //url 64 bit resmin kodunu tutar
      imgData = url;

      var isim = "Şahika  Ağlama Çarşaf";

      //buyuk harfe donustur
      String.prototype.turkishToUpper = function () {
        var string = this;
        var splitStr = string.toLowerCase().split(' ');
        for (var i = 0; i < splitStr.length; i++) {

          splitStr[i] = splitStr[i].charAt(0).toUpperCase() + splitStr[i].substring(1);
        }

        return splitStr.join(' ');

      };

      isim = isim.turkishToUpper();
      //////////

      const pageImage = new Image();
      pageImage.src = imgData;
      pageImage.onload = function () {
        const canvas = document.querySelector("canvas");
        canvas.width = pageImage.naturalWidth;
        canvas.height = pageImage.naturalHeight;

        const ctx = canvas.getContext("2d");
        ctx.imageSmoothingEnabled = false;
        ctx.drawImage(pageImage, 0, 0);
        ctx.shadowBlur = 5;
        ctx.shadowOffsetX = 6;
        ctx.fillStyle = "#575656";
        ctx.shadowColor = "white";

        // ctx.font = "600 100px Poppin";
        ctx.font = ' 120px "Poppin"';

        ctx.textAlign = "center";
        ctx.fillText(isim, canvas.width / 2 + 250, 2555);

        saveScreenshot(canvas);
      };
      function saveScreenshot(canvas) {
        let fileName = "image";
        const link = document.createElement("a");
        link.download = fileName + ".png";


        canvas.toBlob(function (blob) {
          console.log("blob", blob);
          link.href = URL.createObjectURL(blob);
          console.log("object,link", link)
          shareApp(link)
          link.click();
        });
      }
      //////////
    });
    //açılır açılmaz ekrana boyutu bassın
    resize();
    function resize() {
      var canvas = document.querySelector("canvas");
      var canvasRatio = 3508 / 2480;
      var windowRatio = window.innerHeight / window.innerWidth;
      var width;
      var height;

      if (windowRatio < canvasRatio) {
        height = window.innerHeight;
        width = height / canvasRatio;
      } else {
        width = window.innerWidth;
        height = width * canvasRatio;
      }

      canvas.style.width = width + "px";
      canvas.style.height = height + "px";
    }

    function shareApp(link) {
      var url = link;
      console.log("url", url)
      var title = "Sertifika";

      var via = "yourTwitterUsername";
      //console.log( url );
      //console.log( title );

      //facebook
      $('#share-wa').attr('data-url', url).attr('data-title', title).attr('data-sharer', 'whatsapp');
      //facebook
      $('#share-fb').attr('data-url', url).attr('data-sharer', 'facebook');
      //twitter
      $('#share-tw').attr('data-url', url).attr('data-title', title).attr('data-via', via).attr('data-sharer', 'twitter');
      //linkedin
      $('#share-li').attr('data-url', url).attr('data-sharer', 'linkedin');
      // google plus
      $('#share-gp').attr('data-url', url).attr('data-title', title).attr('data-sharer', 'googleplus');
      // email

      //Prevent basic click behavior
      $(".sharer button").click(function () {
        event.preventDefault();
      });


      // only show whatsapp on mobile devices  
      var isMobile = false; //initiate as false
      // device detection
      if (/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|ipad|iris|kindle|Android|Silk|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(navigator.userAgent)
        || /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(navigator.userAgent.substr(0, 4))) {
        isMobile = true;
      }

      if (isMobile == true) {
        $("#share-wa").hide();
      }








    }
  </script>
</body>

</html>